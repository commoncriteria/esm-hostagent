<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="..\transforms\module2html.xsl"?>

<?xml-model href="../transforms/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>

<Module xmlns="https://niap-ccevs.org/cc/v1"
    xmlns:h="http://www.w3.org/1999/xhtml"
    name="Host Agent"
    boilerplate="yes"
    target-products="Host Agent">

  <PPReference>
    <ReferenceTable>
      <PPVersion>1.0</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2019-12-11</PPPubDate>
      <Keywords>Host Agent, ESM</Keywords>
    </ReferenceTable>
  </PPReference>

  <RevisionHistory>
    <entry>
      <version>1.0</version>
      <date>2019-12-11</date>
      <subject>Draft - first version released</subject>
    </entry>
  </RevisionHistory>
  
  <chapter title="Introduction" id="int">
    <section title="Overview" id="ppoverview"> The scope of this PP-Module is to
      describe the security functionality of a Host Agent in terms of CC
      and to define functional and assurance requirements for such products. This Module 
      is not complete in itself, but rather uses the Protection Profile for 
      Application Software <cite linkend="bibAppPP"/> as a Base-PP. The combined requirements 
      in this Host Agent Module with the Application Software PP is meant to be paired with an evaluation using 
      an Enterprise Security Management (ESM) Protection Profile. The ESM PP covers the security 
      functionality needed on the server or cloud service, and the paired Host Agent Module
      covers the security functionality needed on the endpoint device (desktop, mobile device, 
      etc.). At this time only the ESM <cite linkend="bibEDRPP"/> PP is published and ready for use with
      this Host Agent Module. Future
      versions of this Module will include requirements for other classes of Enterprise Security 
      Management software.
    </section>
    <tech-terms>
      <term abbr="AES" full="Advanced Encryption Standard"/>
      <term abbr="ANSI" full="American National Standards Institute"/>
      <term abbr="API" full="Application Programming Interface"/>
      <term abbr="ASLR" full="Address Space Layout Randomization"/>
      <term abbr="CESG" full="Communications-Electronics Security Group"/>
      <term abbr="CMC" full="Certificate Management over CMS"/>
      <term abbr="CMS" full="Cryptographic Message Syntax"/>
      <term abbr="CN" full="Common Names"/>
      <term abbr="CRL" full="Certificate Revocation List"/>
      <term abbr="CSA" full="Computer Security Act"/>
      <term abbr="DEP" full="Data Execution Prevention"/>
      <term abbr="DES" full="Data Encryption Standard"/>
      <term abbr="DHE" full="Diffie-Hellman Ephemeral"/>
      <term abbr="DNS" full="Domain Name System"/>
      <term abbr="DRBG" full="Deterministic Random Bit Generator"/>
      <term abbr="DSS" full="Digital Signature Standard"/>
      <term abbr="DT" full="Date/Time Vector"/>
      <term abbr="DTLS" full="Datagram Transport Layer Security"/>
      <term abbr="EAP" full="Extensible Authentication Protocol"/>
      <term abbr="ECDHE" full="Elliptic Curve Diffie-Hellman Ephemeral"/>
      <term abbr="ECDSA" full="Elliptic Curve Digital Signature Algorithm"/>
      <term abbr="FIPS" full="Federal Information Processing Standards"/>
      <term full="Endpoint">A computing device that runs a general purpose OS, mobile device OS, or network device OS. Endpoints can 
      include desktops, servers, and mobile devices.
      </term>
      
      <term full="Enrolled State">The state in which an endpoint with a running Host Agent is managed by an ESM.
      Also, referred to as Onboarding.
      </term>
      
      <term full="Enrollment">The process of transitioning an endpoint from an unenrolled to an enrolled state.
      </term>
      
      <term full="Enterprise Security Management" abbr="ESM">A enterprise security management application hosted on a server or cloud service that provides 
      support for security management, information flows, reporting, policy, and data analytics 
      in complex enterprise environments.
      </term>
      
      
      <term full="Endpoint Detection and Response" abbr="EDR">A system that analyzes collected EDR Host Agent data for detecting, 
      investigating, and remediating unauthorized activities on endpoints. 
      </term>
      <term full="Host Agent">A logical piece of software that executes on endpoints to collect data about the endpoint and
      executes commands sent to the endpoint from an Enterprise Security Management (ESM) server
      or service. An example command sent to an endpoint could be to enforce a policy from an 
      ESM, to collect some files, or to run an OS command.
      </term>

      <term abbr="HMAC" full="Hash-based Message Authentication Code"/>
      <term abbr="HTTP" full="Hypertext Transfer Protocol"/>
      <term abbr="HTTPS" full="Hypertext Transfer Protocol Secure"/>
      <term abbr="IETF" full="Internet Engineering Task Force"/>
      <term abbr="IP" full="Internet Protocol"/>
      <term abbr="ISO" full="International Organization for Standardization"/>
      <term abbr="IT" full="Information Technology"/>
      <term abbr="ITSEF" full="Information Technology Security Evaluation Facility"/>
      
      <term abbr="NIAP" full="National Information Assurance Partnership"/>
      <term abbr="NIST" full="National Institute of Standards and Technology"/>
      <term abbr="OCSP" full="Online Certificate Status Protocol"/>
      <term abbr="OID" full="Object Identifier"/>
      <term abbr="OMB" full="Office of Management and Budget"/>
      
      <term full="Operating System" abbr="OS">Software that manages physical and logical resources and provides services
      for applications.
      </term>
      
      <term abbr="PII" full="Personally Identifiable Information"/>
      <term abbr="PKI" full="Public Key Infrastructure"/>
      <term abbr="PP" full="Protection Profile"/>
      <term abbr="RBG" full="Random Bit Generator"/>
      <term abbr="RFC" full="Request for Comment"/>
      <term abbr="RNG" full="Random Number Generator"/>
      <term abbr="RNGVS" full="Random Number Generator Validation System"/>
      <term abbr="SAN" full="Subject Alternative Name"/>
      <term abbr="SAR" full="Security Assurance Requirement"/>
      <term abbr="SFR" full="Security Functional Requirement"/>
      <term abbr="SHA" full="Secure Hash Algorithm"/>
      <term abbr="S/MIME" full="Secure/Multi-purpose Internet Mail Extensions"/>
      <term abbr="SIP" full="Session Initiation Protocol"/>
      <term abbr="SWID" full="Software Identification"/>
      
      <term full="Unenrolled State">The state in which an endpoint, with or without a Host Agent, is not managed by an ESM.
      Also, referred to as Offboarding.
      </term>
      <term abbr="TLS" full="Transport Layer Security"/>
      <term abbr="URI" full="Uniform Resource Identifier"/>
      <term abbr="URL" full="Uniform Resource Locator"/>
      <term abbr="USB" full="Universal Serial Bus"/>
      <term abbr="XCCDF" full="eXtensible Configuration Checklist Description Format"/>
      <term abbr="XOR" full="Exclusive Or"/>
    </tech-terms>
    
    <section title="Compliant Targets of Evaluation" id="TOEdescription">
      <subsection title="TOE Boundary" id="toeboundary">
        The term Host Agent is the logical representation of all the software from the TOE
        vendor that represents its functionality. The boundary for the Host Agent includes 
        all processes, all modules and libraries bundled with the Host Agent.  The Host 
        Agent can run as a daemon or service on the platform but is not required to. The Host Agent is
        not expected to have a local or remote Graphical User Interface (GUI) for administration but having 
        such an interface is not precluded by this Module. It is expected that Host Agents will be managed by
        their associated ESM Server or the underlying platform. 
        The TOE boundary includes the communications channel with other Host Agents, an ESM Server, or a cloud 
        service. The platform operating system or execution environment
        upon which the Host Agent is executing is outside the scope of a Host Agent evaluation. The figures
        below show some sample Host Agents but are not inclusive of every possible Host Agent design. 
               
        <h:table>
          <h:tr>
            <h:td>
              <figure entity="images/Host_Agent_sample.png" title="Sample Host Agent TOE" id="toe"/>
            </h:td>
            <h:td>
              <figure entity="images/Host_Agent_sample2.png" title="Sample Host Agent TOE" id="toe"/>
            </h:td>
          </h:tr>
        </h:table>
        
      </subsection>
      <subsection title="TOE Platform" id="TOEplatform">
        The TOE platform consists of a general purpose OS, a mobile device 
        OS, a network device OS, or an Execution Environment on top of which 
        the Host Agent software executes.
      </subsection>
    </section>
    
    <section title="Use Cases" id="usecases">Requirements in this Protection Profile are designed to
      address the security problems in at least the following use cases. These use cases are intentionally
      very broad, as many specific use cases exist for an operating system. These use cases may also
      overlap with one another.  An operating system's functionality may even be effectively extended by
      privileged applications installed onto it.  However, these are out of scope of this PP. 
      <usecases>
        <usecase title="Communication" id="comms">
          <description>The Host Agent allows for communication interactively or
            non-interactively with other Enterprise Security Management (ESM) software over a communications channel.
            Example communications include but are not limited to; receiving policy, sending data and running tasks 
            or commands.
          </description>
        </usecase>
      </usecases>
    </section>
  </chapter>
  
  <chapter title="Conformance Claims" id="conf">
    <cclaims>
      <cclaim title="Conformance Statement">
        <description> This <abbr linkend="PP-Module"/> inherits exact conformance as required from
          the specified <abbr linkend="Base-PP"/> and as defined in the <abbr linkend="CC"/> and
            <abbr linkend="CEM"/> addenda for Exact Conformance, Selection-Based SFRs, and Optional
          SFRs (dated May 2017).<htm:br/><htm:br/> 
        </description>
      </cclaim>
      <cclaim title="CC Conformance Claims">
        <description>This <abbr linkend="PP-Module"/> is conformant to Parts 2 (extended) and 3
          (conformant) of Common Criteria Version 3.1, Release 5 [<abbr linkend="CC"/>].
        </description>
      </cclaim>
      <cclaim title="Package Claims">
        <description>This <abbr linkend="PP-Module"/> is TLS Package Version 1.1
          Conformant.</description>
      </cclaim>
    </cclaims>
  </chapter>

  <chapter title="Security Problem Description" id="spd">The security problem is described in terms
    of the threats that the Host Agent is expected to address, assumptions about the
    operational environment, and any organizational security policies that the Host Agent
    is expected to enforce. 
    <section title="Threats" id="threats">Note that this PP-Module does not repeat the threats identified in the <cite linkend="bibAppPP"/>, though they all apply given the conformance and hence dependence of this PP-Module on the <cite linkend="bibAppPP"/>.
      
      
      <threats>
          <threat id="T.DATA_LOSS">
          <description>A Host Agent can be susceptible to data loss during periods when connectivity
            to the Enterprise Security Management (ESM) system is not present. 
          </description>
          <objective-refer ref="O.DATA_RECORDER">
            <rationale>The threat T.DATA_LOSS is countered by O.DATA_RECORDER as this
              provides for caching of data by a Host Agent during periods when not connected to the ESM 
              system.
            </rationale>
          </objective-refer>
        </threat>
        <threat id="T.TAMPER">
          <description>A Host Agent can be susceptible to tampering by unprivileged users who may try to uninstall
            or disrupt the Host Agent's ability to function properly.
          </description>
          <objective-refer ref="O.ACCOUNTABILITY">
            <rationale>The threat T.TAMPER is countered by O.ACCOUNTABILITY and O.INTEGRITY which protect
              the Host Agent and report artifact up to the ESM system that could help to discover tampering.
            </rationale>
          </objective-refer>
        </threat>
      </threats>
    </section>
    <section id="Assumptions" title="Assumptions">
      <assumptions>
        
        
       
      
      </assumptions>
    </section>
    <section title="Organizational Security Policies" id="OSPs">
      This PP-Module defines no additional organizational security policies beyond those defined in the Base-PP.
    </section>
  </chapter>
  
  
  <!-- SME: right now not all objectives in the Module are mapped to threats because the template requires these
  to be defined with respect to the threats. Some objectives in the Module mitigate threats inherited from the Base-PP
  and are not restated in the Module. As a result the mappings are incomplete. This will need to be resolved. -->
  <chapter title="Security Objectives" id="obj">
    <section title="Security Objectives for the TOE" id="SecurityObjectivesTOE">
      <SOs>
        <SO id="O.ACCOUNTABILITY">
          <description>Conformant Host Agents ensure that information exists that allows
            administrators to discover unintentional issues with the configuration and operation of
            the Host Agent.</description>
          <addressed-by>FAU_GEN.1, FAU_STO_EXT.1</addressed-by>
          <consistency-rationale>
            This objective relates to the TOE's generation and storage of audit data that is used to detect potential configuration or operational issues on host systems. This functionality is defined by the PP-Module
            and does not affect the ability of the TOE to enforce the Base-PP's security objectives.
          </consistency-rationale>
        </SO>
        <SO id="O.DATA_RECORDER">
          <description>
            Conformant Host Agents ensure that collected information is cached or queued during periods
            when the trusted channel is not available. This will prevent data loss of Host Agent data.
          </description>
          <addressed-by>FHA_CHA_EXT.1 (selection-based), FHA_COL_EXT.1 (selection-based), FHA_HAD_EXT.1</addressed-by>
          <consistency-rationale>
            This objective relates to the availability of data collected by the TSF. This data is specified to ESM Host Agent
            functionailty and does not affect the functionality defined by the Base-PP.
          </consistency-rationale>
        </SO>
        <SO id="O.INTEGRITY">
          <description>
            Conformant Host Agents will ensure the integrity of policy and/or commands sent to 
            the Host Agent and also leverage execution environment or platform-based mitigations
            to protect the Host Agent.
          </description>
          <addressed-by>FMT_POL_EXT.1 (objective), FMT_UNR_EXT.1</addressed-by>
          <consistency-rationale>
            This objective is the same as the Base-PP objective of the same name. This PP-Module extends the objective
            by defining additional requirements to satisfy the objective that relate to the specific functionality described by the PP-Module.
          </consistency-rationale>
        </SO>
        <SO id="O.MANAGEMENT">
          <description>To facilitate management by the enterprise, conformant Host Agents
            provide consistent and supported interfaces for their
            security-relevant configuration and maintenance.
          </description>
          <addressed-by>FMT_SMF.1/1</addressed-by>
          <consistency-rationale>
            This objective is the same as the Base-PP objective of the same name. This PP-Module extends the objective
            by defining additional requirements to satisfy the objective that relate to the specific functionality described by the PP-Module.
          </consistency-rationale>
        </SO>
        <SO id="O.PROTECTED_COMMS">
          <description> To address both passive (eavesdropping) and active (packet modification)
            network attack threats, conformant Host Agents will use a trusted channel 
            for sending and receiving data.
          </description>
          <addressed-by>FTP_DIT_EXT.1 (from Base-PP), FTP_DIT_EXT.2 (selection-based)</addressed-by>
          <consistency-rationale>
            This objective is the same as the Base-PP objective of the same name. This PP-Module extends the objective
            by defining additional requirements to satisfy the objective that relate to the specific functionality described by the PP-Module.
          </consistency-rationale>
        </SO>
      </SOs>
    </section>
    <section title="Security Objectives for the Operational Environment"
      id="SecurityObjectivesTOEorEnvironment">The following security objectives for the operational
      environment assist the Host Agent in correctly providing its security functionality.
      These track with the assumptions about the environment. 
      <SOEs>
        
      </SOEs>
    </section>
    <section id="secconrat" title="Security Objectives Rationale">
    </section>
  </chapter>
  
  <chapter title="Security Requirements" id="req">
    
    <base-pp 
      product="application"
      version="1.3"
      name="Application Software" short="App" 
      url="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=394&amp;id=394"
      xmlurl="https://raw.githubusercontent.com/commoncriteria/application/c51970161d3a47fe8a7c23552f372745a638ba7d/input/application.xml">
      <sec-func-req-dir>
        In a PP-Configuration that includes App PP, the TOE is expected to rely on some of the security functions implemented by the application 
        as a whole and evaluated against the Base-PP.
        The SFRs listed in this section are defined in the Base-PP and relevant to the secure operation of the Host Agent.
        This section describes any modifications that the ST author must make to the Base-PP SFRs to satisfy the required Host Agent functionality.
      </sec-func-req-dir>
      
      <modified-sfrs>
        <subsection title="User Data Protection" id="FDP">
        <f-component name="Network Communications" id="FDP_NET_EXT.1">
          <consistency-rationale></consistency-rationale>
           
        <f-element id="fil-age-net"> <!--fha_had_ext.1.2">-->
          <title> 
            The Host Agent shall restrict network communications to; 
            <selectables linebreak="yes">
              <selectable id="AGT_MGMT">an ESM Server</selectable>
              <selectable id="AGT_PEER">another Host Agent</selectable>
            </selectables>
          </title>
          <note role="application">
            By selecting another Host Agent 
            the additional FTP_DIT_EXT.2
            requirements must be included in the ST for peer-to-peer communication. <h:br/>
            This restricts the selections in the Base-PP to a specific list of communications that may be user or application initiated.
          </note>
          <aactivity>
            <TSS>The TSS is unchanged from the Base-PP.</TSS>
            <Guidance>The guidance is unchanged from the Base-PP.</Guidance>
            <Tests>The tests are unchanged from the Base-PP.</Tests>
            
          </aactivity>
        </f-element>    
        
        </f-component>
        </subsection>
      </modified-sfrs>
      <additional-sfrs>

     
      
      
      </additional-sfrs>
      
      <con-toe>
        If this PP-Module is used to extend the Application Software PP, the TOE type for the overall TOE is still a
        software-based application. The TOE boundary is simply extended to include the Host Agent functionality 
        that is built into the application so that additional security functionality is claimed within the scope of the TOE.
      </con-toe>
    
      <con-sec-prob/>
      <con-obj/>
      <con-op-en>
        This PP-Module does not define any objectives for the TOE's operational environment. 
      </con-op-en>
   
      <con-mod id="T.DATA_LOSS">This threat relates to the loss of data that is collected by the ESM Host Agent.
      This relates to functionality defined by the PP-Module and does not interfere with the functionality described by the Base-PP.</con-mod>
      <con-mod id="T.TAMPER">This threat is an extension of the T.LOCAL_ATTACK threat defined by the Base-PP. The threat 
      of tampering as applied to the PP-Module exists in addition to the local attacks that are possible on the capabilities
      defined by the Base-PP.</con-mod>
   
    </base-pp>
    
      <man-sfrs>
           <subsection title="Security Audit (FAU)" id="fau">
       
       <!-- SME: this was changed from FAU_GEN.1/HA because the iteration convention defines the (1) notation
       and that is a fixed part of the module template. -->
        <f-component id="fau_gen.1" name="Audit Data Generation (Refined)">
          <consistency-rationale>
            The Base-PP does not define an audit mechanism for its own functionality. This function does not interfere with the Base-PP.
          </consistency-rationale>
          <f-element>
            <title> 
              The Host Agent shall generate an audit record of the following auditable events: 
              <h:ol type='a'>
                <h:li>Enrollment with an Enterprise Management System (Success/Failure);</h:li>
                <h:li>Change in enrollment state with an Enterprise Management System;</h:li>
                <h:li>
                  <selectables><selectable>Receiving</selectable><selectable>Generating</selectable>
                  </selectables> periodic heartbeat events
                </h:li>
                <h:li><assignable>other specifically defined auditable events</assignable></h:li>
              </h:ol>
              .
            </title>
            <note role="application">
              The required audit events must be generated by the Host Agent, but can leverage
              API's available from the platform if needed to generate the audit events.
            </note>
            <aactivity>
           <TSS>The evaluator shall verify the TSS lists all records that are recorded.</TSS>
            
              <Guidance>
              The evaluator shall check the administrative guide and ensure
              that it lists all of the auditable events.  The evaluator shall
              check to make sure that every audit event type selected in the ST
              is included.</Guidance>
              
              <Tests>
                <testlist>
                  <test>
                    The evaluator shall test the Host Agent's ability to correctly generate
                    audit records by having the Host Agent generate audit records for the
                    events listed in the ST.
                  </test>
                </testlist>
              </Tests>
             
            
</aactivity>
          </f-element>
          <f-element>
            <title> The 
              <selectables>
                <selectable>Host Agent</selectable>
                <selectable>Host Agent Platform</selectable>
              </selectables> 
              shall record within each audit record at least the following information: 
              <h:ol type='a'>
                <h:li>Date and time of the event,</h:li>
                <h:li>Type of event,</h:li>
                <h:li>Subject identity,</h:li>
                <h:li>(Success or failure) of the event, if relevant,</h:li>
                <h:li><assignable>Other audit relevant information</assignable></h:li>
              </h:ol>
              .
            </title>
            <note role="application">
              All audits must contain at least the information mentioned in FAU_GEN.1.2,
              but may contain more information. The term <h:i>subject</h:i> here is understood 
              to be the user that the process is acting on behalf of. The subject identity can
              be blank if not applicable for a given process.
            </note>
            <aactivity>
              
              <TSS>The evaluator shall verify that the TSS lists all the types of events and all audit information that the TOE records.</TSS>
               
              <Guidance>
              The evaluator shall check the administrative guide and ensure
              that it provides a format
              for audit records. Each audit record format type must be covered,
              along with a brief description of each field. The evaluator shall
              ensure that the fields contains the information required.
                
            </Guidance>
              
              <Tests>
                <testlist>
                  <test>
                    The evaluator shall
                    ensure the audit records generated during testing match the
                    format specified in the administrative guide, and that the fields
                    in each audit record provide the required information.
                  </test>
                </testlist>
              </Tests>
</aactivity>
          </f-element>
        </f-component>
             
             <ext-comp-def fam-id="FAU_STO_EXT" title="Audit Data Storage">
               <mod-def>Components in this family define requirements for the location and method of audit storage.</mod-def>
             </ext-comp-def>
      
        <f-component id="fau_sto_ext.1" name="Audit Data Storage">
          <consistency-rationale>
            The Base-PP does not define an audit mechanism for its own functionality. This function does not interfere with the Base-PP.
          </consistency-rationale>
          
          <comp-lev> requires either the TOE or its platform to store audit data using the platform's logging mechanism.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          
          <f-element>
            <title> 
              The
              <selectables>
                <selectable>Host Agent</selectable>
                <selectable>Host Agent Platform</selectable>
              </selectables> 
              shall store audit events in the platform provided logging mechanism.
            </title>
            <note role="application">
              The term <h:i>audit events</h:i> here is understood to be only the set of events
              defined in FAU_GEN.1. If the job of this Host Agent is to generate
              or collect events for an enterprise security management server it is not expected 
              that those events will be stored in the platform provided logging mechanism.
            </note>
            <aactivity>
              
             <TSS>The evaluator shall verify the TSS contains details of where all audit data is stored.</TSS>
              
              <Guidance>
              The evaluator shall check the administrative guide and ensure
              that the list of auditable events are stored in the platform provided logging 
              mechanism.
              </Guidance>
              
              <Tests>
                <testlist>
                  <test>
                    The evaluator shall test the Host Agent's ability to correctly generate
                    audit records by having the TOE generate audit records for the
                    events listed in the ST.  This should include all instance types
                    of an event specified.  
                    When verifying the test results, the evaluator shall ensure the
                    audit records generated during testing are stored in the platform provided logging
                    mechanism. 
                    <h:br/>
                    On Linux based platforms this would be in var/logs. On Windows based 
                    platforms this would be the Windows Event Log.
                    <h:br/>
                    No specific locations are defined for other platforms.
                  </test>
                </testlist>
              </Tests>
          
</aactivity>
          </f-element>
       
        </f-component>
            
      </subsection>
      
      <!-- SME: note that FHA is an extended class. To satisfy APE_ECD, there should also be a definition for the
      class itself and not just the components in it. I don't know if there is currently a way to do that in the template
      so it has been left out for now. -->
      <subsection title="Host Agent (FHA)" id="fha">
        
        <ext-comp-def fam-id="FHA_HAD_EXT" title="Host Agent Declaration">
          <mod-def>Components in this family define requirements for the ESM functionality that the TOE is compatible with.</mod-def>
        </ext-comp-def>
       
        <f-component id="fha_had_ext.1" name="Host Agent Declaration">
          <consistency-rationale>
            This SFR defines the type of software the Host Agent is intended to operate 
            and communicate with. This relates to functionality not present in the Base-PP and does not affect the TOE's ability to satisfy the Base-PP's SFRs.
          </consistency-rationale>
          
          <comp-lev> requires the TOE to be compatible with one or more types of ESM capabilities and to identify how
            its network communications are restricted in support of that compatibility.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          
          <f-element id="fil-decl"><!--fha_had_ext.1.1">-->
            <title> 
              The Host Agent shall operate with the following ESM Software; 
              <!--<selectables linebreak="yes">
                <selectable id="AGT_EDR">>--><h:br/>Endpoint Detection and Response (EDR) <!--</selectable>
                <selectable id="AGT_SM">Systems Management</selectable>
                <selectable id="AGT_AUD">Audit Server</selectable>
              </selectables>>-->
            </title>
            <note role="application">
              Select the appropriate management system that is intended to be paired with 
              this Host Agent. Currently, a NIAP PP only exists for EDR, Systems Management and Audit Server will be added later. By selecting EDR 
              the additional FHA_CHA_EXT.1 and FHA_COL_EXT.1
              requirements shall be included in the ST. 
              <h:br/>
            </note>
            <aactivity>
              
              <TSS>The evaluator shall verify the TSS lists all classes of products the Host Agent is designed to function with.</TSS>
              
              <Guidance>   
              The evaluator shall check the administrative guide and ensure
              that guidence exists for enrollment with all compatible ESM products.
  
            </Guidance>
              
              <Tests>
                <testlist>
                  <test>
                    Conditional: If EDR is selected the evaluator shall install the Host Agent and enroll it with the EDR 
                    management system. The evaluator shall verify that enrollment was successful and 
                    that the Host Agent is communicating with the EDR.
                  </test>
                </testlist>
              </Tests>
</aactivity>
          </f-element>
        </f-component>
        

      </subsection>
      
      <subsection title="Security Management (FMT)" id="fmt">
        
        <f-component id="fmt_smf.1" iteration="1"
		     name="Specification of Management Functions (Configuration of Host Agent)">
          <consistency-rationale>
            This SFR defines management functions for the SFRs defined in this PP-Module. It does not affect the management functions defined in the Base-PP.
          </consistency-rationale>
          <f-element><!-- id="FMT_SMF.1.1(1)">-->
            <title>The <h:b>Host Agent</h:b> shall be capable of the
              following management functions:
              <h:br/>
              <management-function-set default="O">
                <manager id="a">Administrator</manager>
                <management-function>
                  <text>
                    Configure the frequency for sending Host Agent data to an ESM
                  </text>
                  <M ref="a"/>
                </management-function>
                <management-function>
                  <text>
                    Assign at least one label or tag to categorize individual endpoint systems
                  </text>
                  <M ref="a"/>
                </management-function>
              </management-function-set>
            </title>
            <note role="application"> This requirement captures all the configuration functionality
              the TSF provides the administrator to configure the Host Agent. The configuration of
              these management functions can be achieved by either local configuration of the Host Agent or by 
              remote configuration using the ESM Server.
              The frequency for sending data to an ESM can be specified as a time value, but does not have
              to be. A value like Aggressive, Normal, Low Bandwidth is a measure of control of frequency and meets
              the requirement.
            </note>
            <aactivity>
              
              <TSS>The evaluator shall verify the TSS contains all frequencies for sending Host Agent data to an ESM and all labels that are permitted.</TSS>
 
              <Guidance>   
              The evaluator shall verify that every management function 
              mandated by the PP-Module is described in the operational guidance and that the description 
              contains the information required to perform the management duties associated with the 
              management function.</Guidance>
              
              <Tests>
                <testlist>
                  <test>
                    The evaluator shall test the ability to configure the Host Agent and test each option 
                    from above. The evaluator is expected to test these functions in all the ways in which 
                    the ST and guidance documentation state    the configuration can be managed.
                  </test>
                </testlist>
              </Tests>
             
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def fam-id="FMT_UNR_EXT" title="User Unenrollment Prevention">
          <mod-def>Components in this family define requirements for ensuring that an unprivileged user
           cannot remove the TOE from management by another ESM component.</mod-def>
        </ext-comp-def>
        
        <f-component id="fmt_unr_ext.1" name="User Unenrollment Prevention">
          <consistency-rationale>
            This SFR defines protections to prevent users from tampering with the Host Agent. This relates to functionality not present in the Base-PP and does not affect the TOE's ability to satisfy the Base-PP's SFRs.
          </consistency-rationale>
          
          <comp-lev> requires the TSF to prevent its unenrollment by an unauthorized user.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          
          <f-element>
            <title>The 
              <selectables>
                <selectable>Host Agent</selectable>
                <selectable>Host Agent Platform</selectable>
              </selectables> 
              shall enforce a mechanism to prevent unprivileged users of the platform from
              unenrolling the Host Agent with the ESM system.
            </title>
            <note role="application">
              Unenrolling is the action of transitioning from the enrolled state to the
              unenrolled state. Preventing unprivileged users from unenrolling the Host Agent
              provides assurance that the enterprise can manage connected endpoints. 
            </note>
            <aactivity>
                         
              <TSS>
              The evaluator shall ensure that the TSS describes the mechanism used to
              prevent users from unenrolling the Host Agent.</TSS>
              
              <Guidance>There is no associated guidance for this requirement.</Guidance> 
              
              <Tests>
                <testlist>
                  <test>
                    The evaluator shall attempt to unenroll the Host Agent from the ESM system
                    as an unprivileged user and verify that the attempt fails, by trying to kill the process
                    or stop the Service or Daemon that is running the Host Agent.
                  </test>
                </testlist>
              </Tests>
              
            </aactivity>
          </f-element>        
        </f-component>
        
      </subsection>
    </man-sfrs>
    
    <opt-sfrs></opt-sfrs>
    
    <sel-sfrs>
     <subsection title="Host Agent (FHA)" id="fha">
       
       <ext-comp-def fam-id="FHA_CHA_EXT" title="Cache Host Agent Collected Data">
         <mod-def>Components in this family define requirements for the location and duration of storage for its collected data.</mod-def>
       </ext-comp-def>
       
      <f-component id="fha_cha_ext.1" name="Cache Host Agent Collected Data">
        <selection-depends req="fil-decl" ids="AGT_EDR"/>
        <consistency-rationale>
          This SFR defines how the Host Agent shall cache data locally. This relates to functionality not present in the Base-PP and does not affect the TOE's ability to satisfy the Base-PP's SFRs.
        </consistency-rationale>
        
        <comp-lev> requires either the TOE or its platform to store audit data using the platform's logging mechanism.</comp-lev>
        <management>No specific management functions are identified.</management>
        <audit>There are no auditable events foreseen.</audit>
        <dependencies>FHA_COL_EXT.1 Collected Audit<h:br/>
          FHA_HAD_EXT.1 Host Agent Declaration</dependencies>
        
        <f-element>
          <title> 
            The <h:b>Host Agent</h:b> shall cache collected data for a minimum of <assignable>value greater than 72</assignable> hours on 
            <selectables>
              <selectable>persistent storage</selectable>
              <selectable>non-persistent storage</selectable>
            </selectables>
            if the trusted channel is not available.
          </title>
          <note role="application">
            The term <h:i>collected data</h:i> here is understood to be any type of collected endpoint data by the Host Agent
            destined for an enterprise security management (ESM) server. To meet this requirement a Host Agent must be
            capable of locally caching or queuing data for a minimum value that is greater than 72 hours (3 days) during periods of network
            dis-connectivity. In a future revision the selection of non-persistent storage will be removed.
          </note>
          <aactivity>
            
            <TSS>The evalutator shall verify the TSS details how data is cached and any rules that would effect data caching.</TSS>
            <Guidance>The evalutor shall verify that any configuration options related to data caching is listed in the guidance.</Guidance>
            
            <Tests>
              <testlist>
                <test>
                  The evaluator shall test the Host Agents ability to cache data by disconnecting the endpoint
                  from the network for a period of 72 hours to simulate a network connectivity failure, 
                  these should be actual hours not via changing system time. The evaluator shall
                  exercise behaviors on the endpoint during the 72 hour time frame to generate Host Agent data.
                  Example behaviors could be running programs, performing some authentications, installing/uninstalling 
                  software, or sample test cases provided by the vendor to generate Host Agent data.
                  The evaluator will then reconnect the endpoint to the network and verify on the ESM system 
                  that the missing data from the 72 hour time frame is available on the ESM management portal.
                </test>
              </testlist>
            </Tests>
            
          </aactivity>
        </f-element>
        
      </f-component>  
       
       <ext-comp-def fam-id="FHA_COL_EXT" title="Collected Audit">
         <mod-def>Components in this family define requirements for the collection of data the TOE collects from 
           its operational environment as audit data.</mod-def>
       </ext-comp-def>
      
      <f-component id="fha_col_ext.1" name="Collected Audit" >
        <selection-depends req="fil-decl" ids="AGT_EDR"/>
        <consistency-rationale>
          This SFR defines the type of software the Host Agent is intended to operate with. This relates to functionality not present in the Base-PP and does not affect the TOE's ability to satisfy the Base-PP's SFRs.
        </consistency-rationale>
        
        <comp-lev> requires the TOE to collect a specified set of data from its operational environment.</comp-lev>
        <management>No specific management functions are identified.</management>
        <audit>There are no auditable events foreseen.</audit>
        <dependencies>FHA_HAD_EXT.1 Host Agent Declaration</dependencies>
        
        <f-element>
          <title>The Host Agent shall collect the following minimum set of
            endpoint event data: <h:ol type="a">
              <h:li>Operating System (OS) version, architecture, and IP Address</h:li>
              <h:li>Privileged and unprivileged endpoint account login activity</h:li>
              <h:li>Process creation</h:li>
              <h:li>Libraries and modules loaded by processes</h:li>
              <h:li>Network connection activity, including destination IP</h:li>
              <h:li>Files created on persistent storage</h:li>
              <h:li><assignable>Other host data</assignable></h:li>
            </h:ol>
          </title>
          <note role="application">The intent of this requirement is to specify the minimum
            set of endpoint data that the Host Agent for an ESM EDR system must be capable of 
            collecting. This requirement only applies to Host Agents used with the 
            <cite linkend="bibEDRPP"/> PP per
            the selection from FHA_HAD_EXT.1.
          </note>
          <aactivity>
            
            <TSS>The evaluator shall verify the TSS contains a full list of endpoint data that can be collected.</TSS>
            <Guidance> 
            The evaluator shall check the administrative guide and ensure
            that it lists all of the collectable types of endpoint event data.  
            The evaluator shall check to make sure that every endpoint event 
            type listed in the ST is included in the administrative guidance.</Guidance> 
            <Tests>
              The evalutator shall review the items collected by the Host Agent and verify all items in the minimum set are included.
            </Tests>
            
          </aactivity>
        </f-element>
      </f-component>
     </subsection>
      
     <subsection title="Trusted Path/Channels (FTP)" id="ftp">
       
       <ext-comp-def fam-id="FTP_DIT_EXT" title="Protection of Data in Transit">
         <mod-def>This family is defined in the <cite linkend="bibAppPP"/>. This PP-Module adds a component
         to the existing family definition.</mod-def>
       </ext-comp-def>
       
      <f-component id="ftp_dit_ext.2" name="Protection of Data in Transit for Peer-to-Peer Host Agents">
        <selection-depends req="fil-age-net" ids="AGT_PEER"/>
        <consistency-rationale>
          This SFR defines the communication channel for Host Agents communicating with other Host Agents. This relates to functionality not present in the Base-PP and does not affect the TOE's ability to satisfy the Base-PP's SFRs.
        </consistency-rationale>
        
        <comp-lev> requires the TSF to secure data in transit between itself and another ESM Host Agent using TLS.</comp-lev>
        <management>No specific management functions are identified.</management>
        <audit>There are no auditable events foreseen.</audit>
        <dependencies>FCS_TLS_EXT.1 TLS Protocol <h:br/>
          [FCS_TLSC_EXT.1 TLS Client Protocol OR <h:br/>
          FCS_TLSS_EXT.1 TLS Server Protocol] <h:br/>
          FHA_HAD_EXT.1 Host Agent Declaration</dependencies>
        
        <f-element>
          <title>The Host Agent shall encrypt all transmitted data according to FPT_DIT_EXT.1 between itself and another Host Agent.
          </title>
          <note role="application">
            This requirement is designed to protect the communications with other Host Agents 
            in a peer-to-peer scenario where Host Agents are sending/receiving data from each other.
            
          </note>  
          <aactivity>
            
            <TSS>The evaluator shall verify that the TSS contains a description of all data transmitted to other Host Agents and 
            that all such data is protected by according to FPT_DIT_EXT.1.</TSS>
            <Guidance>The evaluator shall ensure the guidance contains any configuration details required for ensuring data transmitted
            to other Host Agents is protected by TLS.</Guidance> 
            
            <Tests>
              <testlist>
                <test>
                  The evaluator shall exercise the Host Agent (attempting to cause transmission of data)
                  while capturing packets from the Host Agent. The evaluator shall verify from the packet
                  capture that the traffic is 
                  encrypted in accordance with the selections in the ST. 
                </test>
              </testlist>
            </Tests>
            
          </aactivity>
        </f-element>
      </f-component>
     </subsection>
      
    </sel-sfrs>
    
    <obj-sfrs>
     <subsection title="Security Management (FMT)" id="fmt">
       
       <ext-comp-def fam-id="FMT_POL_EXT" title="Trusted Policy Update">
         <mod-def>Components in this family define requirements for the TOE's verification of policies or commands transmitted to it.</mod-def>
       </ext-comp-def>
       
      <f-component id="fmt_pol_ext.1" name="Trusted Policy Update">
        <consistency-rationale>
          This SFR defines protections for the integrity of commands sent to the Host Agent. This relates to functionality not present in the Base-PP and does not affect the TOE's ability to satisfy the Base-PP's SFRs.
        </consistency-rationale>
        
        
        <comp-lev> requires the TSF to reject any unsigned management policies or commands sent to it.</comp-lev>
        <management>No specific management functions are identified.</management>
        <audit>There are no auditable events foreseen.</audit>
        <dependencies>FCS_COP.1 Cryptographic Operation</dependencies>
        
        <f-element>
          <title>The 
            <selectables>
              <selectable>Host Agent</selectable>
              <selectable>Host Agent Platform</selectable>
            </selectables> 
            shall only accept policies or commands that are digitally signed in accordance with FCS_COP.1.1(3).
          </title>
          <note role="application">
            The intent of this requirement is to cryptographically tie any policy updates or
            commends sent to the Host Agent as being from the ESM Server. This is not to 
            protect the policies in transit as they are already protected by FTP_DIT_EXT.1.1
            and/or FTP_DIT_EXT.2.1. The digital signature used to sign policies or commands
            must be selected in FCS_COP.1.1(3). The use of this requirement makes FCS_COP.1.1(3)
            from the Base-PP a mandatory requirement.
          </note>
          <aactivity>
            
            <TSS>
            The evaluator shall ensure that the TSS describes how the candidate 
            policies or commands are sent to the Host Agent; the
            processing associated with verifying the digital signature of the policies or
            commands; and the actions that take place for successful (signature was
            verified) and unsuccessful (signature could not be verified) cases. The
            software components that are performing the processing must also be
            identified in the TSS and verified by the evaluators (this could be the Host Agent
            or the underlying platform).
            
            </TSS>
            
            <Guidance>There is no associated guidance for this requirement.</Guidance>
            
            <Tests>
              <testlist>
                <test>
                  The evaluator shall perform or wait for a policy update or commands 
                  from an ESM Server to be sent to a Host Agent. The evaluator shall verify the
                  policy or command is signed and is provided to the Host Agent. The evaluator shall
                  verify the Host Agent accepts the digitally signed policy.
                  <h:br/>
                  <h:br/>
                  The execution of this test may require some configuration or a test version of either
                  the Host Agent of the ESM system in order to view the incoming policy or command
                  and verify that the content is digitally signed.
                </test>
                <test>
                  The evaluator shall alter a policy update or command and verify the Host Agent rejects the altered policy.
                </test>
              </testlist>
            </Tests>
  
           
</aactivity>
        </f-element>        
      </f-component>
     </subsection>
    </obj-sfrs>
    
  </chapter>

  <bibliography>
    <cc-entry/>
    <entry id="bibAppPP">
      <tag>AppPP</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/pp/PP_APP_v1.1/">Protection Profile for Application Software</h:a>
      </description>
    </entry>
    <entry id="bibEDRPP">
      <tag>EDR</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/pp/">Protection Profile for Endpoint Detection and Response</h:a>
      </description>
    </entry>
  </bibliography>
  
  <acronyms/>
  
</Module>
