<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../transforms/pp2html.xsl"?>


<PP xmlns="https://niap-ccevs.org/cc/v1" name="Extended Package for Host Agent"
  xmlns:h="http://www.w3.org/1999/xhtml">
  
  <PPReference title="PP Reference">
    <ReferenceTable>
      <PPTitle>Extended Package for Host Agent</PPTitle>
      <PPVersion>1.0</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2018-07-16</PPPubDate>
      <PPCertificationID>unassigned</PPCertificationID>
      <CCVersion>3.1R4</CCVersion>
      <Keywords>Host Agent, ESM</Keywords>
      <entry>
        <name>Registration</name>
        <description>National Information Assurance Partnership</description>
      </entry>
    </ReferenceTable>
  </PPReference>

  <RevisionHistory>
    <entry>
      <version>1.0</version>
      <date>2018-07-16</date>
      <subject>Draft - first version released</subject>
    </entry>
  </RevisionHistory>

  <chapter title="Introduction" id="int">
    <section title="Overview" id="ppoverview"> The scope of this Extended Package is to
      describe the security functionality of a Host Agent in terms of <cite linkend="bibCC"/>
      and to define functional and assurance requirements for such products. This EP 
      is not complete in itself, but rather extends the Protection Profile for 
      Application Software <cite linkend="bibAppPP"/>. The combined requirements 
      in this Host Agent EP with the Application Software PP is met to be paired with an evaluation using 
      an Enterprise Security Management (ESM) Protection Profile. The ESM PP covers the security 
      functionality needed on the server or cloud service, and the paired Host Agent EP
      covers the security functionality needed on the endpoint device (desktop, mobile device, 
      etc.). At this time only the ESM <cite linkend="bibEDRPP"/> PP is published and ready for use with
      this Host Agent EP. Future
      versions of this Host Agent EP will include requirements for other classes of Enterprise Security 
      Management software.
    </section>
    <section title="Terms" id="glossary"> The following sections provide both Common Criteria and
      technology terms used in this Protection Profile. 
       <glossary>
          <entry>
            <term><abbr title="Common Criteria">CC</abbr></term>
            <description>Common Criteria for Information Technology Security
              Evaluation.</description>
          </entry>
          <entry>
            <term><abbr title="Common Evaluation Methodology">CEM</abbr></term>
            <description>Common Evaluation Methodology for Information Technology Security
              Evaluation.</description>
          </entry>
          <entry>
            <term><abbr title="Protection Profile">PP</abbr></term>
            <description>An implementation-independent set of security requirements for a category
              of products.</description>
          </entry>
          <entry>
            <term><abbr title="Security Target">ST</abbr></term>
            <description>A set of implementation-dependent security requirements for a specific
              product.</description>
          </entry>
          <entry>
            <term><abbr title="Target of Evaluation">TOE</abbr></term>
            <description>
	      The product under evaluation. In this case, the Operating System as described in section 
	      <xref linkend="TOEboundary"/> and its
              supporting documentation.
	    </description>
          </entry>
          <entry>
            <term><abbr title="TOE Security Functionality">TSF</abbr></term>
            <description>The security functionality of the product under evaluation.</description>
          </entry>
          <entry>
            <term><abbr title="TOE Summary Specification">TSS</abbr></term>
            <description>A description of how a <abbr linkend="TOE"/> satisfies the SFRs in a <abbr
                linkend="ST"/>. </description>
          </entry>
          <entry>
            <term><abbr title="Security Functional Requirement">SFR</abbr></term>
            <description>A requirement for security enforcement by the <abbr linkend="TOE"/>.
            </description>
          </entry>
          <entry>
            <term><abbr title="Security Assurance Requirement">SAR</abbr></term>
            <description>A requirement to assure the security of the <abbr linkend="TOE"/>.
            </description>
          </entry>
         <entry>
           <term>Endpoint</term>
           <description>A computing device that runs a General Purpose Operating System 
             or a Mobile Device Operating System. Endpoints can 
             include desktops, servers, and mobile devices.
           </description>
         </entry>
         <entry>
           <term>Enrolled State</term>
           <description>The state in which an endpoint with a running Host Agent is managed by an ESM.
           </description>
         </entry>
         <entry>
           <term><abbr title="Enterprise Security Management">ESM</abbr></term>
           <description>
             A enterprise management portal hosted on a server or cloud service that provides 
             support for security management, information flows, reporting, policy, and data analytics 
             in complex enterprise environments.
           </description>
         </entry>
         <entry>
           <term><abbr title="Endpoint Detection and Response">EDR</abbr> System</term>
           <description>A system that analyzes collected EDR Host Agent data for detecting, 
             investigating, and remediating unauthorized activities on endpoints. 
           </description>
         </entry>
         <entry>
           <term>Host Agent</term>
           <description>A logical piece of software that executes on endpoints to collect data about the endpoint,
             execute commands sent to the endpoint from an Enterprise Security Management (ESM) server
             or service. An example command sent to an endpoint could be to enforce a policy from an 
             ESM, or to collect some files, or to run an OS command.
           </description>
         </entry>
         <entry>
           <term>Onboarding</term>
           <description>The processes of taking an endpoint from the Unenrolled State to the
             Enrolled State. The act of initial provisioning with an ESM. The term onboarding
             can be used interchangeably with the term enrollment in the context of a Host Agent.
           </description>
         </entry>
         <entry>
           <term><abbr title="Operating System">OS</abbr></term>
           <description> Software that manages physical and logical resources and provides services
             for applications.</description>
         </entry>
         <entry>
           <term>Unenrolled State</term>
           <description>The state in which an endpoint, with or without a Host Agent, is not managed by an ESM.
           </description>
         </entry>
        </glossary>
    </section>
    <section title="Compliant Targets of Evaluation" id="TOEdescription">
      <subsection title="TOE Boundary" id="TOEboundary">
        The term Host Agent is the logical representation of all the software from the TOE
        vendor the represents the functionality of a Host Agent. The boundary for the Host Agent includes 
        all processes, all modules and libraries bundled with the Host Agent.  The Host 
        Agent can run as daemons or services on the platform but is not required too. The Host Agent is
        not expected to have a local or remote Graphical User Interface (GUI) for administration but having 
        such an interface is not precluded by this EP. It is expected that Host Agents will be managed by
        their associated ESM Server or the underlying platform. 
        The TOE boundary includes the communications channel with other Host Agents, an ESM server, or a cloud 
        service. The platform operating system or execution environment
        upon which the Host Agent is executing is outside the scope of a Host Agent evaluation. The figures
        below show some sample Host Agents but are not inclusive of every possible Host Agent design. 
               
        <h:table>
          <h:tr>
            <h:td>
              <figure entity="images/Host_Agent.jpg" title="Sample Host Agent TOE" id="toe"/>
            </h:td>
            <h:td>
              <figure entity="images/Host_Agent_sample.jpg" title="Sample Host Agent TOE" id="toe"/>
            </h:td>
          </h:tr>
        </h:table>
        
      </subsection>
      <subsection title="TOE Platform" id="TOEplatform">
        The TOE platform consists of a General Purpose Operating System, a Mobile Device 
        Operating System, a Network Device Operating System, or an Execution Environment on top of which 
        the Host Agent software executes.
      </subsection>
    </section>
    <section title="Use Cases" id="usecases">Requirements in this Protection Profile are designed to
      address the security problems in at least the following use cases. These use cases are intentionally
      very broad, as many specific use cases exist for an operating system. These use cases may also
      overlap with one another.  An operating system's functionality may even be effectively extended by
      privileged applications installed onto it.  However, these are out of scope of this PP. 
      <usecases>
        <usecase title="Communication" id="comms">
          <description>The Host Agent allows for communication interactively or
            non-interactively with other Enterprise Security Management (ESM) software over a communications channel.
            Example communications include but are not limited to; receiving policy, sending data and running tasks 
            or commands.
          </description>
        </usecase>
      </usecases>
    </section>
  </chapter>

  <chapter title="Conformance Claims" id="conf">
    <cclaims>
      <cclaim id="Conformance Statement">
        <description> The Protection Profile for Application Software (App PP) defines the baseline
          Security Functional Requirements (SFRs) and Security Assurance Requirements (SARs) for
          application software products. This EP serves to extend the App PP baseline with
          additional SFRs and associated Assurance Activities specific to a Host Agent. Assurance
          Activities are the actions that the evaluator performs in order to determine a Host
          Agent’s compliance to the SFRs.<h:br/> This EP conforms to Common Criteria <cite
            linkend="bibCC"/> for Information Technology Security Evaluation, Version 3.1, Revision
          4. It is CC Part 2 extended and CC Part 3 conformant. In order to be conformant to this
          EP, the ST must include all components in this EP and the associated App PP that are:
          <h:ul><h:li>unconditional (which are always required)</h:li>
            <h:li>selection-based (which are required when certain selections are chosen in the
              unconditional requirements)</h:li>
          </h:ul> and may include optional and/or objective components that are desirable but not
          required for conformance. </description>
      </cclaim>
    </cclaims>
    <section title="How to Use This Extended Package" id="howto"> As an EP of the <cite
      linkend="bibAppPP"/>, it is expected that the content of both this EP and the <cite
        linkend="bibAppPP"/> be appropriately combined in the context of each product-specific
      Security Target. This EP has been specifically defined such that there should be no difficulty
      or ambiguity in so doing. An ST must identify the applicable versions of the <cite
        linkend="bibAppPP"/> (see http://www.niap-ccevs.org/pp/ for the current version) and this EP
      in its conformance claims. When requirements are referenced from the <cite linkend="bibAppPP"
      />, a short notation is included. </section>
  </chapter>

  <chapter title="Security Problem Definition" id="spd">The security problem is described in terms
    of the threats that the Host Agent is expected to address, assumptions about the
    operational environment, and any organizational security policies that the Host Agent
    is expected to enforce. <section title="Threats" id="threats">
      <threats>
        <threat id="T.DATA_LOSS">
          <description>A Host Agent can be susceptible to data loss during periods when connectivity
            to the Enterprise Security Management (ESM) system is not present. 
          </description>
          <objective-refer ref="O.DATA_LOSS">
            <rationale>The threat T.DATA_LOSS is countered by O.DATA_RECORDER as this
              provides for caching of data by a Host Agent during periods when not connected to the ESM 
              system.
            </rationale>
          </objective-refer>
        </threat>
      </threats>
    </section>
    <section title="Assumptions" id="assumptions">
      <h:p>
        Reference the Protection Profile for Application Software <cite linkend="bibAppPP"/> for Assumptions.
      </h:p>
    </section>

  </chapter>
  <chapter title="Security Objectives" id="obj">
    <section title="Security Objectives for the TOE" id="SecurityObjectivesTOE">
      <SOs>
        <SO id="O.ACCOUNTABILITY">
          <description>Conformant Host Agents ensure that information exists that allows
            administrators to discover unintentional issues with the configuration and operation of
            the Host Agent.</description>
          <component-refer ref="FAU_GEN.1"/>
          <component-refer ref="FAU_STO.1"/>
        </SO>
        <SO id="O.DATA_RECORDER">
          <description>
            Conformant Host Agents ensure that collected information is cached or queued during periods
            when the trusted channel is not available. This will prevent data loss of Host Agent data.
          </description>
          <component-refer ref="FHA_CHA_EXT.1"/>
          <component-refer ref="FHA_COL_EXT.1"/>
        </SO>
        <SO id="O.INTEGRITY">
          <description>
            Conformant Host Agents will ensure the integrity of policy and/or commands sent to 
            the Host Agent and also leverage execution environment or platform-based mitigations
            to protect the Host Agent.
          </description>
          <component-refer ref="FMT_POL_EXT.1"/>
          <component-refer ref="FMT_UNR_EXT.1"/>
        </SO>
        <SO id="O.MANAGEMENT">
          <description>To facilitate management by the enterprise, conformant Host Agents
            provide consistent and supported interfaces for their
            security-relevant configuration and maintenance.
          </description>
          <component-refer ref="FMT_SMF.1"/>
        </SO>
        <SO id="O.PROTECTED_COMMS">
          <description> To address both passive (eavesdropping) and active (packet modification)
            network attack threats, conformant Host Agents will use a trusted channel 
            for sending and receiving data.
          </description>
          <component-refer ref="FTP_DIT_EXT.1"/>
          <component-refer ref="FTP_DIT_EXT.2"/>
        </SO>
      </SOs>
    </section>
    <section title="Security Objectives for the Operational Environment"
      id="SecurityObjectivesTOEorEnvironment">The following security objectives for the operational
      environment assist the Host Agent in correctly providing its security functionality.
      These track with the assumptions about the environment. <SOEs>
        <SOE id="OE.PLATFORM">
          <description>The Host Agent relies on being installed on a trusted
            platform.</description>
        </SOE>
        <SOE id="OE.PROPER_USER">
          <description> The user of the Host Agent is not willfully negligent or hostile,
            and uses the software within compliance of the applied enterprise security policy.
           </description>
        </SOE>
        <SOE id="OE.PROPER_ADMIN">
          <description> The administrator of the Host Agent is not careless, willfully
            negligent or hostile, and administers the Host Agent within compliance of the applied enterprise
            security policy. 
          </description>
        </SOE>
      </SOEs></section>
    <section title="Security Objectives Rationale" id="SOR">This section describes how the
      assumptions, threats, and organizational security policies map to the security objectives.
      <InsertSPDCorrespondence/></section>
  </chapter>
  <chapter title="Security Requirements" id="req">This chapter describes the security requirements
    which have to be fulfilled by the Host Agent. Those requirements comprise functional
    components from Part 2 and assurance components from Part 3 of <cite linkend="bibCC"/>. The
    following notations are used: <h:ul>
      <h:li>
        <h:b>Refinement</h:b> operation (denoted by <h:b>bold text</h:b>): is used to add details to a
        requirement, and thus further restricts a requirement.</h:li>
      <h:li>
        <h:b>Selection</h:b> (denoted by <h:i>italicized text</h:i>): is used to select one or more options
        provided by the [CC] in stating a requirement.</h:li>
      <h:li>
        <h:b>Assignment</h:b> operation (denoted by <h:span class="assignable-content">italicized text</h:span>): is used to assign a
        specific value to an unspecified parameter, such as the length of a password. Showing the
        value in square brackets indicates assignment.</h:li>
      <h:li>
        <h:b>Iteration</h:b> operation: are identified with a number inside parentheses (e.g.
        "(1)")</h:li>
    </h:ul>

    <section title="Security Functional Requirements" id="SFRs">The Security Functional Requirements
      included in this section are derived from Part 2 of the Common Criteria for Information
      Technology Security Evaluation, Version 3.1, Revision 5, with additional extended functional
      components.

      <subsection title="Security Audit (FAU)" id="fau">
       
        <f-component id="fau_gen.1" name="Audit Data Generation (Refined)">
          <f-element id="fau_gen.1.1">
            <title> 
              The
              <selectables>
                <selectable>Host Agent</selectable>
                <selectable>Host Agent Platform</selectable>
              </selectables> 
              shall be able to generate an audit record of the following auditable events: 
              <h:ol type='a'>
                <h:li>Start-up and shut-down of the Host Agent;</h:li>
                <h:li>Initial enrollment status with an Enterprise Management System (Success/Failure);</h:li>
                <h:li>Change in enrollment state of a Host Agent;</h:li>
                <h:li><assignable>other specifically defined auditable events</assignable></h:li>
              </h:ol>
              .
            </title>
            <aactivity>
              <h:p>
                The evaluator shall check the administrative guide and ensure
                that it lists all of the auditable events.  The evaluator shall
                check to make sure that every audit event type selected in the ST
                is included.
              </h:p>
              <h:p>
                The evaluator shall test the Host Agents ability to correctly generate
                audit records by having the TOE generate audit records for the
                events listed in the ST.  This should include all instance types
                of an event specified.  
                When verifying the test results, the evaluator shall ensure the
                audit records generated during testing match the format specified
                in the administrative guide, and that the fields in each audit
                record have the proper entries.
              </h:p>
            </aactivity>
          </f-element>
          <f-element id="fau_gen.1.2">
            <title> The 
              <selectables>
                <selectable>Host Agent</selectable>
                <selectable>Host Agent Platform</selectable>
              </selectables> 
              shall record within each audit record at least the following information: 
              <h:ol type='a'>
                <h:li>date and time of the event,</h:li>
                <h:li>type of event,</h:li>
                <h:li>subject identity,</h:li>
                <h:li>(success or failure) of the event, if relevant,</h:li>
                <h:li><assignable>other audit relevant information</assignable></h:li>
              </h:ol>
              .
            </title>
            <note role="application">
              All audits must contain at least the information mentioned in FAU_GEN.1.2,
              but may contain more information. The term <h:i>subject</h:i> here is understood 
              to be the user that the process is acting on behalf of.  
            </note>
            <aactivity>
              <h:p>
                The evaluator shall check the administrative guide and ensure
                that it provides a format
                for audit records. Each audit record format type must be covered,
                along with a brief description of each field. The evaluator shall
                ensure that the fields contains the information required. 
              </h:p>
              <h:p>
                The evaluator shall test the Host Agents ability to correctly generate
                audit records by having the TOE generate audit records for the
                events listed in the ST.
                The evaluator shall
                ensure the audit records generated during testing match the
                format specified in the administrative guide, and that the fields
                in each audit record provide the required information.
              </h:p>
            </aactivity>
          </f-element>
        </f-component>
      
        <f-component id="fau_sto.1" name="Audit Data Storage">
          <f-element id="fau_sto.1.1">
            <title> 
              The
              <selectables>
                <selectable>Host Agent</selectable>
                <selectable>Host Agent Platform</selectable>
              </selectables> 
              shall store audit events in the platform provided logging mechanism.
            </title>
            <note role="application">
              The term <h:i>audit events</h:i> here is understood to be only the set of events
              defined in <linkref linkend="FAU_GEN.1"/>. If the job of this Host Agent is to generate
              or collect events for an enterprise security management server it is not expected 
              that those events will be stored in the platform provided logging mechanism.
            </note>
            <aactivity>
              <h:p>
                The evaluator shall check the administrative guide and ensure
                that the list of auditable events are stored in the platform provided logging 
                mechanism.
              </h:p>
              <h:p>
                The evaluator shall test the Host Agents ability to correctly generate
                audit records by having the TOE generate audit records for the
                events listed in the ST.  This should include all instance types
                of an event specified.  
                When verifying the test results, the evaluator shall ensure the
                audit records generated during testing are stored in the platform provided logging
                mechanism. 
                <h:br/>
                On Linux based platforms this would be in var/logs. On Windows based 
                platforms this would be the Windows Event Log.
              </h:p>
            </aactivity>
          </f-element>
       
        </f-component>
        
        
        
      </subsection>
      
      <subsection title="Host Agent (FHA)" id="fha">
       
        <f-component id="fha_had_ext.1" name="Host Agent Declaration">
          <f-element id="fha_had_ext.1.1">
            <title> 
              The Host Agent shall operate with the following ESM Software;
              <selectables>
                <selectable id="AGT_EDR">Endpoint Detection and Response</selectable>
                <selectable></selectable>
              </selectables> 
              .
            </title>
            <note role="application">
              Future revisions of this Host Agent EP will add additional selections to this requirement
              but at this time only Endpoint Detection and Response can be selected and evaluated with 
              this EP.
            </note>
            <aactivity>
              <h:p>
                The evaluator shall check the administrative guide and ensure
                that the Host Agent product under evaluation matches with the type of
                ESM under evaluation.
              </h:p>
            </aactivity>
          </f-element>    
        </f-component>
        
        <f-component id="fha_cha_ext.1" name="Cache Host Agent Collected Data" status="sel-based">
          <selection-depends req="fha_had_ext.1.1" ids="AGT_EDR"/>
          <f-element id="fha_cha_ext.1.1">
            <title> 
              The <h:b>Host Agent</h:b> shall cache collected data for a minimum of 72 hours on 
              <selectables>
                <selectable>persistent  storage</selectable>
                <selectable>non-persistent  storage
                </selectable>
              </selectables>
              if the trusted channel is not available.
            </title>
            <note role="application">
              The term <h:i>collected data</h:i> here is understood to be any type of collected endpoint data by the Host Agent
              destine for an enterprise security management (ESM) server. To meet this requirement a Host Agent must be
              capable of locally caching or queuing data for a minimum of 72 hours (3 days) during periods of network
              dis-connectivity. In a future revision the selection of non-persistent storage will be removed.
            </note>
            <aactivity>
              The evaluator shall test the Host Agents ability to cache data by disconnecting the endpoint
              from the network for a period of 72 hours to simulate a network connectivity failure. The evaluator shall
              exercise some behaviors on the endpoint during the 72 hour time frame to generate some Host Agent data.
              Example behaviors could be running programs, performing some authentications, installing/uninstalling some
              other unrelated software.
              The evaluator will then reconnect the endpoint to the network and verify on the ESM system 
              that the missing data from the 72 hour time frame is available on the ESM management portal.
            </aactivity>
          </f-element>
               
        </f-component>
        
        <f-component id="fha_col_ext.1" name="Collected Audit" status="sel-based">
          <selection-depends req="fha_had_ext.1.1" ids="AGT_EDR"/>
          <f-element id="fha_col_ext.1.1">
            <title>The Host Agent shall collect the following minimum set of
              endpoint event data: <h:ol type="a">
                <h:li>Operating System (OS) version, architecture, and IP Address</h:li>
                <h:li>Privileged and unprivileged endpoint account login activity</h:li>
                <h:li>Process creation</h:li>
                <h:li>Libraries and modules loaded by processes</h:li>
                <h:li>Network connection activity, including destination IP</h:li>
                <h:li>Files created on persistent storage</h:li>
                <h:li><assignable>other host data</assignable></h:li>
              </h:ol>
            </title>
            <note role="application">The intent of this requirement is to specify the minimum
              set of endpoint data that the Host Agent for an ESM EDR system must be capable of 
              collecting. This requirement only applies to Host Agents used with the 
              <cite linkend="bibEDRPP"/> PP per
              the selection from <linkref linkend="FHA_HAD_EXT.1"/>.
            </note>
            <aactivity>
              <h:p>
                The evaluator shall check the administrative guide and ensure
                that it lists all of the collectable types of endpoint event data.  
                The evaluator shall
                check to make sure that every endpoint event data type selected in the ST
                is included in the administrative guidance.
              </h:p>
            </aactivity>
          </f-element>
        </f-component>
        
      </subsection>
      
      <subsection title="Security Management (FMT)" id="fmt">
        
        <f-component id="FMT_SMF.1(1)"
          name="Specification of Management Functions (Configuration of Host Agent)">
          <f-element id="FMT_SMF.1.2(1)">
            <title>The <h:b>Host Agent</h:b> shall be capable of the
              following management functions:
              <h:br/>
              <management-function-set default="O">
                <manager id="a">Administrator</manager>
                <management-function>
                  <text>
                    Configure the frequency for sending host agent data to an ESM
                  </text>
                  <M ref="a"/>
                </management-function>
                <management-function>
                  <text>
                    Assign at least one label or tag to categorize individual endpoint systems
                  </text>
                  <M ref="a"/>
                </management-function>
              </management-function-set>
            </title>
            <note role="application"> This requirement captures all the configuration functionality
              the <abbr linkend="TSF"/> provides the administrator to configure the Host Agent. The configuration of
              these management functions can be achieved by either local configuration of the Host Agent or by 
              remote configuration using the ESM management software.
              The frequency for sending data to an ESM can be specified as a time value, but does not have
              to be. A value like Aggressive, Normal, Low Bandwidth is a measure of control of frequency and meets
              the requirement.
            </note>
            <aactivity>
              The evaluator shall verify that every management function 
              mandated by the EP is described in the operational guidance and that the description 
              contains the information required to perform the management duties associated with the 
              management function. 
              <testlist>
                <test>
                  The evaluator shall test the ability to configure the Host Agent and test each option selected 
                  from above. The evaluator is expected to test these functions in all the ways in which 
                  the <abbr title="Security Target" linkend="ST">ST</abbr> and guidance documentation state
                  the configuration can be managed.
                </test>
              </testlist>
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component id="FMT_POL_EXT.1" name="Trusted Policy Update" status="objective">
          <f-element id="FMT_POL_EXT.1.1">
            <title>The 
              <selectables>
                <selectable>Host Agent</selectable>
                <selectable>Host Agent Platform</selectable>
              </selectables> 
              shall only accept policies or commands that are digitally signed
            </title>
            <note role="application">
              The intent of this requirement is to cryptographically tie any policy updates or
              commends sent to the Host Agent as being from the Enterprise. This is not to 
              protect the policies in transit as they are already protected by FTP_DIT_EXT.1.1
              and/or FTP_PTP_EXT.1.1. The digital signature used to sign policies or commands
              must be selected in FCS_COP.1.1(3). The use of this requirement makes FCS_COP.1.1(3)
              from the base Application Software PP a mandatory requirement.
            </note>
            <aactivity>
              The evaluator shall ensure that the TSS
              describes how the candidate policies or commands are sent to the Host Agent; the
              processing associated with verifying the digital signature of the policies or
              commands; and the actions that take place for successful (signature was
              verified) and unsuccessful (signature could not be verified) cases. The
              software components that are performing the processing must also be
              identified in the TSS and verified by the evaluators (this could be the Host Agent
              or the underlying platform).
              <testlist>
                <test>
                  The evaluator shall perform or wait for a policy update or commands 
                  from an ESM Server to be sent to a Host Agent. The evaluator shall verify the
                  policy or command is signed and is provided to the Host Agent. The evaluator shall
                  verify the Host Agent accepts the digitally signed policy.
                  <h:br/>
                  <h:br/>
                  The execution of this test may require some configuration or a test version of either
                  the Host Agent of the ESM system in order to view the incoming policy or command
                  and verify that the content is digitally signed.
                </test>
              </testlist>
            </aactivity>
          </f-element>        
        </f-component>
      
        <f-component id="FMT_UNR_EXT.1" name="User Unenrollment Prevention">
          <f-element id="FMT_UNR_EXT.1.1">
            <title>The 
              <selectables>
                <selectable>Host Agent</selectable>
                <selectable>Host Agent Platform</selectable>
              </selectables> 
              shall enforce a mechanism to prevent unprivileged users of the platform from
              unenrolling the Host Agent with the ESM system.
            </title>
            <note role="application">
              Unenrolling is the action of transitioning from the enrolled state to the
              unenrolled state. Preventing unprivileged users from unenrolling the Host Agent
              provides assurance that the enterprise can manage connected endpoints. 
            </note>
            <aactivity>
              <testlist>
                The evaluator shall ensure that the TSS describes the mechanism used to
                prevent users from unenrolling the Host Agent.
               <test>
                 The evaluator shall attempt to unenroll the Host Agent from the ESM system
                 as an unpriviledge user and verify that the attempt fails. This could be 
                 performed by trying to uninstall the Host Agent, and trying to kill the running
                 Host Agent process.
               </test>
              </testlist>
            </aactivity>
          </f-element>        
        </f-component>
        
      </subsection>
      
      <subsection title="Trusted Path/Channels (FTP)" id="ftp">
        
        <f-component id="ftp_dit_ext.1" name="Protection of Data in Transit (Refinement)">
          <f-element id="ftp_dit_ext.1.1">
            <title>The Host Agent shall 
              <selectables linebreak="yes">
                <selectable>encrypt all transmitted sensitive data with
                  <selectables>
                    <selectable id="sel_all_https"><h:abbr title="Hypertext Transfer Protocol Secure">HTTPS</h:abbr></selectable>
                    <selectable id="sel_all_tlsc"><h:abbr title="Transport Layer Security">TLS</h:abbr> (as client)</selectable>
                  </selectables>
                </selectable>
                <selectable>encrypt all transmitted data with
                  <selectables>
                    <selectable id="sel_sen_https"><h:abbr title="Hypertext Transfer Protocol Secure">HTTPS</h:abbr></selectable>
                    <selectable id="sel_sen_tlsc"><h:abbr title="Transport Layer Security">TLS</h:abbr> (as client)</selectable>
                  </selectables>
                </selectable>
              </selectables>
              between itself and another trusted IT product.
            </title>
            <note role="application">
              This requirement was modified from its original definition in the 
              base PP (<cite linkend="bibAppPP"/>) to limit certain selections for a Host Agent.
            </note>  
            <aactivity>
              See the Application Software <cite linkend="bibAppPP"/> for Assurance Activities
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component id="ftp_dit_ext.2" name="Protection of Data in Transit for Peer-to-Peer Host Agents">
          <f-element id="ftp_dit_ext.2.1">
            <title>The Host Agent shall 
              <selectables linebreak="yes">
                <selectable>not directly transmit any data </selectable>
                <selectable>encrypt all transmitted data with TLS
                </selectable>
              </selectables>
              between itself and another Host Agent.
            </title>
            <note role="application">
               This requirement is designed to protection the communications with other Host Agents 
               in a peer-to-peer scenario where Host Agents are sending/receiving data from each other.
               If "encrypts all transmitted data with TLS" is selected the appropriate TLSC and TLSS requirements
               must be included in the ST.
            </note>  
            <aactivity>
              The evaluator shall perform the following tests.
              <testlist>
                <test>
                  The evaluator shall exercise the Host Agent (attempting to cause transmission of data)
                  while capturing packets from the Host Agent. The evaluator shall verify from the packet
                  capture that the traffic is 
                  encrypted with <h:abbr title="Transport Layer Security">TLS</h:abbr> or 
                  in accordance with the selections in the <abbr title="Security Target" linkend="ST">ST
                  </abbr>.
                </test>
              </testlist>
            </aactivity>
          </f-element>
        </f-component>
      
      </subsection>
      
    </section>
    
  </chapter>

  <!-- 
       Do NOT put SFRs in this section. All SFR belong up above in SFR section. 
       To make an SFR optional tag it above as status="optional" 
  -->
  <appendix title="Optional Requirements" id="optional"> As indicated in <secref linkend="ccl"/>,
    the baseline requirements (those that must be performed by the Host Agent are
    contained in the body of this PP. Additionally, there are three other types of requirements
    specified in <appref linkend="optional"/>, <appref linkend="sel-based"/>, and <appref
      linkend="objective"/>. The first type (in this Appendix) are requirements that can be included
    in the <abbr linkend="ST"/>, but are not required in order for a Host Agent to claim conformance to
    this PP. The second type (in <appref linkend="sel-based"/>) are requirements based on selections
    in the body of the PP: if certain selections are made, then additional requirements in that
    appendix must be included. The third type (in <appref linkend="objective"/> are components that
    are not required in order to conform to this PP, but will be included in the baseline
    requirements in future versions of this PP, so adoption by vendors is encouraged. Note that the
    ST author is responsible for ensuring that requirements that may be associated with those in
      <appref linkend="optional"/>, <appref linkend="sel-based"/>, and <appref linkend="objective"/>
    but are not listed (e.g., FMT-type requirements) are also included in the ST. </appendix>

  <!-- 
       Do NOT put SFRs in this section. All SFR belong up above in SFR section. 
       To make an SFR optional tag it above as status="sel-based" 
  -->
  <appendix title="Selection-Based Requirements" id="sel-based"> As indicated in the introduction to
    this PP, the baseline requirements (those that must be performed by the Host Agent or its underlying
    platform) are contained in the body of this PP. There are additional requirements based on
    selections in the body of the PP: if certain selections are made, then additional requirements
    below will need to be included. </appendix>

  <!-- 
       Do NOT put SFRs in this section. All SFR belong up above in SFR section. 
       To make an SFR optional tag it above as status="objective" 
  -->
  <appendix title="Objective Requirements" id="objective"> This appendix includes requirements that
    specify security functionality which also addresses threats. The requirements are not currently
    mandated in the body of this PP as they describe security functionality not yet widely-available
    in commercial technology. However, these requirements may be included in the ST such that the
    Host Agent is still conformant to this PP, and it is expected that they be included as soon as
    possible. </appendix>
  
  <appendix title="References" id="biblio">
    <bibliography>
      <entry id="bibCC">
        <tag>CC</tag>
        <description>Common Criteria for Information Technology Security Evaluation - <h:ul>
          <h:li><h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART1V3.1R5.pdf">Part
            1: Introduction and General Model</h:a>, CCMB-2017-04-001, Version 3.1 Revision 5,
            April 2017.</h:li>
          <h:li><h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART2V3.1R5.pdf">Part
            2: Security Functional Components</h:a>, CCMB-2017-04-002, Version 3.1 Revision 5,
            April 2017.</h:li>
          <h:li><h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART3V3.1R5.pdf">Part
            3: Security Assurance Components</h:a>, CCMB-2017-04-003, Version 3.1 Revision 5,
            April 2017.</h:li>
        </h:ul></description>
      </entry>
      <entry id="bibCEM">
        <tag>CEM</tag>
        <description>
          <h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CEMV3.1R4.pdf">Common
            Evaluation Methodology for Information Technology Security - Evaluation Methodology</h:a>,
          CCMB-2012-09-004, Version 3.1, Revision 4, September 2012. </description>
      </entry>
      <entry id="bibCESG">
        <tag>CESG</tag>
        <description>CESG - <h:a
            href="https://www.gov.uk/government/collections/end-user-devices-security-guidance"> End
            User Devices Security and Configuration Guidance</h:a></description>
      </entry>
      <entry id="bibCSA">
        <tag>CSA</tag>
        <description>
          <h:a href="http://csrc.nist.gov/groups/SMA/ispab/documents/csa_87.txt">Computer Security Act
            of 1987</h:a>, H.R. 145, June 11, 1987. </description>
      </entry>
      <entry id="bibOMB">
        <tag>OMB</tag>
        <description>
          <h:a href="http://www.whitehouse.gov/sites/default/files/omb/memoranda/fy2006/m06-19.pdf"
            >Reporting Incidents Involving Personally Identifiable Information and Incorporating the
            Cost for Security in Agency Information Technology Investments</h:a>, OMB M-06-19, July
          12, 2006. </description>
      </entry>
      <entry id="bibAppPP">
        <tag>AppPP</tag>
        <description>
          <h:a href="https://www.niap-ccevs.org/pp/">Protection Profile for Application Software</h:a>
        </description>
      </entry>
      <entry id="bibEDRPP">
        <tag>EDR</tag>
        <description>
          <h:a href="https://www.niap-ccevs.org/pp/">Protection Profile for Endpoint Detection and Response</h:a>
        </description>
      </entry>
    </bibliography>
  </appendix>

  <appendix title="Acronyms" id="acronyms">
    <acronyms>
      <entry>
        <term>AES</term>
        <description>Advanced Encryption Standard</description>
      </entry>
      <entry>
        <term>ANSI</term>
        <description>American National Standards Institute</description>
      </entry>
      <entry>
        <term>API</term>
        <description>Application Programming Interface</description>
      </entry>
      <entry>
        <term>ASLR</term>
        <description>Address Space Layout Randomization</description>
      </entry>
      <entry>
        <term>CESG</term>
        <description>Communications-Electronics Security Group</description>
      </entry>
      <entry>
        <term>CMC</term>
        <description>Certificate Management over CMS</description>
      </entry>
      <entry>
        <term>CMS</term>
        <description>Cryptographic Message Syntax</description>
      </entry>
      <entry>
        <term>CN</term>
        <description>Common Names</description>
      </entry>
      <entry>
        <term>CRL</term>
        <description>Certificate Revocation List</description>
      </entry>
      <entry>
        <term>CSA</term>
        <description>Computer Security Act</description>
      </entry>
      <entry>
        <term>DEP</term>
        <description>Data Execution Prevention</description>
      </entry>
      <entry>
        <term>DES</term>
        <description>Data Encryption Standard</description>
      </entry>
      <entry>
        <term>DHE</term>
        <description>Diffie-Hellman Ephemeral</description>
      </entry>
      <entry>
        <term>DNS</term>
        <description>Domain Name System</description>
      </entry>
      <entry>
        <term>DRBG</term>
        <description>Deterministic Random Bit Generator</description>
      </entry>
      <entry>
        <term>DSS</term>
        <description>Digital Signature Standard</description>
      </entry>
      <entry>
        <term>DT</term>
        <description>Date/Time Vector</description>
      </entry>
      <entry>
        <term>DTLS</term>
        <description>Datagram Transport Layer Security</description>
      </entry>
      <entry>
        <term>EAP</term>
        <description>Extensible Authentication Protocol</description>
      </entry>
      <entry>
        <term>ECDHE</term>
        <description>Elliptic Curve Diffie-Hellman Ephemeral</description>
      </entry>
      <entry>
        <term>ECDSA</term>
        <description>Elliptic Curve Digital Signature Algorithm</description>
      </entry>
      <entry>
        <term>EST</term>
        <description>Enrollment over Secure Transport</description>
      </entry>
      <entry>
        <term>FIPS</term>
        <description>Federal Information Processing Standards</description>
      </entry>
      <entry>
        <term>DSS</term>
        <description>Digital Signature Standard</description>
      </entry>
      <entry>
        <term>HMAC</term>
        <description>Hash-based Message Authentication Code</description>
      </entry>
      <entry>
        <term>HTTP</term>
        <description>Hypertext Transfer Protocol</description>
      </entry>
      <entry>
        <term>HTTPS</term>
        <description>Hypertext Transfer Protocol Secure</description>
      </entry>
      <entry>
        <term>DSS</term>
        <description>Digital Signature Standard</description>
      </entry>
      <entry>
        <term>IETF</term>
        <description>Internet Engineering Task Force</description>
      </entry>
      <entry>
        <term>IP</term>
        <description>Internet Protocol</description>
      </entry>
      <entry>
        <term>ISO</term>
        <description>International Organization for Standardization</description>
      </entry>
      <entry>
        <term>IT</term>
        <description>Information Technology</description>
      </entry>
      <entry>
        <term>ITSEF</term>
        <description>Information Technology Security Evaluation Facility</description>
      </entry>
      <entry>
        <term>NFC</term>
        <description>Near Field Communication</description>
      </entry>
      <entry>
        <term>NIAP</term>
        <description>National Information Assurance Partnership</description>
      </entry>
      <entry>
        <term>NIST</term>
        <description>National Institute of Standards and Technology</description>
      </entry>
      <entry>
        <term>OCSP</term>
        <description>Online Certificate Status Protocol</description>
      </entry>
      <entry>
        <term>OID</term>
        <description>Object Identifier</description>
      </entry>
      <entry>
        <term>OMB</term>
        <description>Office of Management and Budget</description>
      </entry>
      <entry>
        <term>OS</term>
        <description>Operating System</description>
      </entry>
      <entry>
        <term>PII</term>
        <description>Personally Identifiable Information</description>
      </entry>
      <entry>
        <term>PKI</term>
        <description>Public Key Infrastructure</description>
      </entry>
      <entry>
        <term>PP</term>
        <description>Protection Profile</description>
      </entry>
      <entry>
        <term>RBG</term>
        <description>Random Bit Generator</description>
      </entry>
      <entry>
        <term>RFC</term>
        <description>Request for Comment</description>
      </entry>
      <entry>
        <term>RNG</term>
        <description>Random Number Generator</description>
      </entry>
      <entry>
        <term>RNGVS</term>
        <description>Random Number Generator Validation System</description>
      </entry>
      <entry>
        <term>SAN</term>
        <description>Subject Alternative Name</description>
      </entry>
      <entry>
        <term>SAR</term>
        <description>Security Assurance Requirement</description>
      </entry>
      <entry>
        <term>SFR</term>
        <description>Security Functional Requirement</description>
      </entry>
      <entry>
        <term>SHA</term>
        <description>Secure Hash Algorithm</description>
      </entry>
      <entry>
        <term>S/MIME</term>
        <description>Secure/Multi-purpose Internet Mail Extensions</description>
      </entry>
      <entry>
        <term>SIP</term>
        <description>Session Initiation Protocol</description>
      </entry>
      <entry>
        <term>SWID</term>
        <description>Software Identification</description>
      </entry>
      <entry>
        <term>TLS</term>
        <description>Transport Layer Security</description>
      </entry>
      <entry>
        <term>URI</term>
        <description>Uniform Resource Identifier</description>
      </entry>
      <entry>
        <term>URL</term>
        <description>Uniform Resource Locator</description>
      </entry>
      <entry>
        <term>USB</term>
        <description>Universal Serial Bus</description>
      </entry>
      <entry>
        <term>XCCDF</term>
        <description>eXtensible Configuration Checklist Description Format</description>
      </entry>
      <entry>
        <term>XOR</term>
        <description>Exclusive Or</description>
      </entry>
    </acronyms>
  </appendix>
</PP>
